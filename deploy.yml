name: Deploy Streamlit App

on:
  push:
    branches: ["main"]  # D√©clenche le workflow sur un push vers "main"

jobs:
  deploy:
    runs-on: ubuntu-latest
    
    steps:
      # √âtape 1 : R√©cup√®re le code du d√©p√¥t
      - name: Checkout code
        uses: actions/checkout@v4

      # √âtape 2 : Configure Python
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: "3.10"

      # √âtape 3 : Installe les d√©pendances
      - name: Install dependencies
        run: |
          pip install -r requirements.txt
          pip install streamlit

      # √âtape 4 : Ex√©cute des tests (optionnel)
      - name: Run tests
        env:
          GOOGLE_API_KEY: ${{ "AIzaSyDcQXmJPlMH3C34YomL-JzdOmKDI1G3Boc" }}  # Injecte les secrets
        run: |
          python -m pytest tests/

      # √âtape 5 : D√©ploie sur Streamlit (exemple avec un script personnalis√©)
      - name: Deploy to Streamlit
        env:
          GOOGLE_API_KEY: ${{ "AIzaSyDcQXmJPlMH3C34YomL-JzdOmKDI1G3Boc" }}
          DB_PASSWORD: ${{ "AIzaSyDcQXmJPlMH3C34YomL-JzdOmKDI1G3Boc" }}
        run: |
          # Ici, ajoutez la logique pour d√©ployer (ex: CLI d'un h√©bergeur)
          # Exemple fictif pour illustrer :
          echo "D√©ploiement avec les variables s√©curis√©es üöÄ"